% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/event_time_desp.R
\name{show_cif}
\alias{show_cif}
\title{Plot Cumulative Incidence Function for Competing Risks}
\usage{
show_cif(
  surv_obj,
  evt_type = 1,
  evt_label = function(x) {
     recode_factor(x, `1` = "Event", `2` = "Competing event",
    .default = "Event free")
 },
  add_ci = TRUE,
  add_atrisk = TRUE,
  add_legend = FALSE,
  add_pvalue = TRUE,
  atrisk_init_pos = NULL,
  pvalue_pos = c("bottomright", "topleft", "topright", "bottomleft", "left", "right",
    "top", "bottom"),
  plot_theme = theme_minimal(),
  x_lab = "Time",
  y_lab = "Proportion of subjects",
  x_lim = NULL,
  y_lim = NULL,
  x_break = NULL,
  y_break = NULL,
  color_scheme = c("brewer", "grey", "viridis", "manual"),
  color_list = NULL,
  print_fig = TRUE,
  top.margin = 18,
  right.margin = 18,
  bottom.margin = 96,
  left.margin = 96
)
}
\arguments{
\item{surv_obj}{A \code{survfit} object, such as one returned by \code{estimate_cif()}.}

\item{evt_type}{Integer or vector of integers; the event type(s) of interest to be plotted (default = 1).}

\item{evt_label}{A function to relabel event types for plotting (default uses \code{recode_factor()} to label 1 = "Event", 2 = "Competing event", others = "Event free").}

\item{add_ci}{Logical; if \code{TRUE}, adds confidence intervals to the CIF curves (default = TRUE).}

\item{add_atrisk}{Logical; if \code{TRUE}, adds an at-risk table below the plot (default = TRUE).}

\item{add_legend}{Logical; if \code{TRUE}, includes a legend in the plot (default = FALSE).}

\item{add_pvalue}{Logical; if \code{TRUE}, adds a p-value to the plot (default = TRUE).}

\item{atrisk_init_pos}{Character; position of the "At-risk N:" label.}

\item{pvalue_pos}{Character vector indicating where to place the p-value on the plot. Options include "bottomright", "topleft", "topright", "bottomleft", "left", "right", "top", "bottom" (default = all).}

\item{plot_theme}{A \code{ggplot2} theme object to customize the appearance of the plot (default = \code{theme_minimal()}).}

\item{x_lab}{Character; label for the x-axis (default = "Time").}

\item{y_lab}{Character; label for the y-axis (default = "Proportion of subjects").}

\item{x_lim}{Numeric vector of length 2 specifying x-axis limits.}

\item{y_lim}{Numeric vector of length 2 specifying y-axis limits.}

\item{x_break}{Numeric vector specifying x-axis tick positions.}

\item{y_break}{Numeric vector specifying y-axis tick positions.}

\item{color_scheme}{Character; color scheme to use. Options: "brewer", "grey", "viridis", "manual" (default = "brewer").}

\item{color_list}{A named list of colors to use when \code{color_scheme = "manual"} (e.g., \code{list(values = c("red", "blue"))}).}

\item{print_fig}{Logical; if \code{TRUE}, prints the plot (default = TRUE).}

\item{top.margin}{Numeric; top margin space for the at-risk table (default = 18).}

\item{right.margin}{Numeric; right margin space for the at-risk table (default = 18).}

\item{bottom.margin}{Numeric; bottom margin space for the at-risk table (default = 96).}

\item{left.margin}{Numeric; left margin space for the at-risk table (default = 96).}
}
\value{
A \code{ggplot} object representing the cumulative incidence function plot.
}
\description{
Displays the cumulative incidence function (CIF) for competing risks data, with optional stratification and customization.
}
\details{
This function visualizes the cumulative incidence of events in the presence of competing risks using a \code{survfit} object.
It supports customization of axis labels, plot limits, confidence intervals, legends, p-values, and at-risk tables.
}
\examples{
my_plot_theme<- theme_bw() +
theme(axis.title  = element_text(size= 14, family="Arial"),
      axis.title.x= element_text(margin= unit(c(t= 1, r = 0, b = 0, l = 0), "lines"), family="Arial"),
      axis.title.y= element_text(margin= unit(c(t= 0, r = 1, b = 0, l = 0), "lines"), family="Arial"),
      axis.text   = element_text(size= 12, family="Arial"),
      # set the axis line (i.e. bty= "l" in traditional plot)
      axis.line.x = element_line(color="black", size = 1),
      axis.line.y = element_line(color="black", size = 1),

      # specify the legend (e.g. position, color, justification)
      legend.title= element_blank(),
      legend.background= element_rect(fill= "transparent"),
      legend.text      = element_text(family= "Arial", size = 12),
      legend.margin    = margin(t = 0, r = 0, b = 0, l = 0,"bigpts"),
      legend.key       = element_rect(fill= "transparent", color= "transparent", linetype= "blank"),
      legend.key.size  = unit(24, "bigpts"),
      # legend.position= c(0.98, 0.02),
      # legend.justification= c(1, 0),

      #eliminates background, gridlines, and chart border
      panel.border = element_blank(),
      # plot.background = element_blank(),
      # panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      panel.spacing = unit(1, "lines"),

      strip.background = element_rect(fill = "black", color= "white"),
      strip.text = element_text(family = "Arial", color= "white", size = 12, face= "bold"),

      # plot margin. Sufficient margins must be specified for printing at-risk patients.
      plot.margin= unit(c(top= 0.1, right= 0.05, bottom= .3, left= .2), "npc"))

# read in the example data
cmprisk_df<- read.csv2("http://www.stat.unipg.it/luca/misc/bmt.csv")
admin_censor_cmprisk(cmprisk_df, ftime, status, evt_label = c("0"= "Event free", "1"= "Event", "2"= "Competing event"), adm_cnr_time= 10)
p<- cmprisk_df \%>\%
admin_censor_cmprisk(ftime, status,
                     adm_cnr_time= 30,
                     overwrite_var = TRUE) \%>\%
  estimate_cif(ftime, status) \%>\%
  show_cif(evt_type = 1,
           plot_theme= my_plot_theme,
           x_break= seq(0, 10, by= 1),
           y_break= seq(0, .8, by= .1),
           add_pvalue = TRUE,
           add_atrisk = TRUE,
           add_ci = TRUE,
           add_legend = FALSE,
           color_scheme = "manual",
           color_list = list(values= c('blue', 'blue')),
           pvalue_pos= "topleft")

#---- To show the at risk information ----
gt <- ggplot_gtable(ggplot_build(p))
gt$layout$clip[gt$layout$name == 'panel'] <- "off"
grid.draw(gt)
}
